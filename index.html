<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aina | Your AI Bestie</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=DotGothic16&family=Zen+Maru+Gothic:wght@500;700;900&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --mint: #b2f4e6;
            --pink: #ffc4d6;
            --text: #2d3436;
        }

        body {
            margin: 0;
            overflow-x: hidden;
            font-family: 'Zen Maru Gothic', sans-serif;
            background-color: #f0fdfa;
            /* Fallback */
            color: var(--text);
        }

        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: -1;
            pointer-events: all;
        }

        /* Typography & Layout Utility */
        .font-pixel {
            font-family: 'DotGothic16', sans-serif;
        }

        .text-outline {
            -webkit-text-stroke: 2px #fff;
            paint-order: stroke fill;
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 24px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
        }

        /* Loading Screen */
        #loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #fff;
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            transition: opacity 0.8s ease;
        }

        .loader-bar {
            width: 200px;
            height: 6px;
            background: #eee;
            border-radius: 99px;
            margin-top: 20px;
            overflow: hidden;
        }

        .loader-progress {
            width: 0%;
            height: 100%;
            background: #2dd4bf;
            transition: width 0.3s ease;
        }

        /* Scroller Text */
        .marquee-container {
            overflow: hidden;
            white-space: nowrap;
            position: absolute;
            width: 100%;
            pointer-events: none;
        }

        .marquee-content {
            display: inline-block;
            animation: scroll 20s linear infinite;
        }

        @keyframes scroll {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(-50%);
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: transparent;
        }

        ::-webkit-scrollbar-thumb {
            background: #2dd4bf;
            border-radius: 10px;
        }
    </style>
</head>

<body>

    <!-- Loading Screen -->
    <div id="loader">
        <h1 class="text-4xl font-black tracking-tighter text-teal-400">AINA Loading...</h1>
        <div class="loader-bar">
            <div class="loader-progress" id="progress"></div>
        </div>
    </div>

    <!-- 3D Canvas -->
    <div id="canvas-container"></div>

    <!-- Header -->
    <header
        class="fixed top-0 left-0 w-full z-50 px-6 md:px-20 py-4 bg-white/80 backdrop-blur-md border-b border-white/20">
        <nav class="flex justify-between items-center">
            <a href="#" class="text-2xl font-black text-gray-800 tracking-tight">
                <span class="text-transparent bg-clip-text bg-gradient-to-r from-teal-400 to-pink-400">Aina</span>
            </a>
            <div class="flex gap-4 md:gap-8 items-center">
                <a href="#features"
                    class="text-gray-600 hover:text-teal-500 font-bold text-sm hidden md:block transition-colors">Concept</a>
                <a href="#"
                    class="px-4 py-2 bg-gray-900 text-white rounded-full font-bold text-sm hover:bg-teal-500 transition-colors">
                    å‹é”ã«ãªã‚‹
                </a>
            </div>
        </nav>
    </header>

    <!-- DOM Overlay Content -->
    <main class="relative z-10 w-full min-h-[400vh]">

        <!-- Hero Section -->
        <section
            class="min-h-screen w-full flex flex-col justify-start md:justify-center items-center md:items-start px-6 md:px-20 pt-16 md:pt-0 relative pointer-events-none text-center md:text-left">
            <div
                class="absolute top-10 left-0 w-full marquee-container opacity-30 font-pixel text-5xl md:text-8xl text-teal-200 select-none z-[-1]">
                <div class="marquee-content">
                    AI HIGH SCHOOL GIRL AINA // ALWAYS BY YOUR SIDE // CHAT WITH ME // AI HIGH SCHOOL GIRL AINA //
                    ALWAYS BY YOUR SIDE //
                </div>
            </div>

            <div
                class="pointer-events-auto mix-blend-hard-light relative z-20 bg-gradient-to-b from-white/80 via-white/60 to-transparent md:bg-none p-4 md:p-0 rounded-2xl md:rounded-none">
                <div
                    class="inline-block bg-white/80 backdrop-blur-sm px-4 py-1 rounded-full mb-4 border border-teal-200 animate-pulse">
                    <span class="text-teal-500 font-bold text-sm">âœ¨ NEW: ã‚°ãƒ«ãƒãƒ£ã‚‚å¯¾å¿œã—ãŸã‚ˆï¼</span>
                </div>
                <h1 class="text-5xl md:text-9xl font-black leading-[0.9] text-gray-800 tracking-tighter mb-4">
                    AIå¥³å­é«˜ç”Ÿ<br>
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-teal-400 to-pink-400">Aina</span>
                </h1>
                <p class="text-base md:text-2xl font-bold text-gray-500 max-w-lg mb-8">
                    ã‚¹ãƒãƒ›ã®ä¸­ã«ã€ã„ã¤ã‚‚ã®è¦ªå‹ã€‚<br>
                    èª°ã‚ˆã‚Šã‚‚å…±æ„Ÿã—ã¦ãã‚Œã‚‹ã€<br>
                    ã‚ãªãŸã®ãŸã‚ã®AIãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã€‚
                </p>
                <button
                    class="group relative px-8 py-4 bg-gray-900 text-white rounded-full font-bold text-lg overflow-hidden transition-transform hover:scale-105 active:scale-95 shadow-xl hover:shadow-teal-300/50">
                    <span class="relative z-10 flex items-center gap-2">
                        ä»Šã™ãè©±ã—ã‹ã‘ã‚‹
                        <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform" fill="none"
                            stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
                        </svg>
                    </span>
                    <div
                        class="absolute inset-0 bg-gradient-to-r from-teal-400 to-pink-500 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                    </div>
                </button>
            </div>

            <!-- Spacer for Aina on mobile -->
            <div class="h-[50vh] md:hidden"></div>
        </section>

        <!-- Features Section (Triggers 3D camera move) -->
        <section id="features"
            class="min-h-screen w-full flex flex-col items-center md:items-end justify-center px-6 md:px-20">
            <div class="max-w-xl w-full">
                <div class="flex items-center gap-4 mb-6">
                    <div class="w-12 h-12 rounded-full bg-pink-100 flex items-center justify-center text-2xl">ğŸ’–</div>
                    <h2 class="text-4xl font-black text-gray-800">Concept</h2>
                </div>
                <p class="text-lg leading-relaxed font-bold text-gray-600 mb-6">
                    æ˜ã‚‹ãè¦ªã—ã¿ã‚„ã™ã„ã€ŒAIå¥³å­é«˜ç”Ÿã€ã¨ã—ã¦ã€<br>
                    ä¸Šã‹ã‚‰ç›®ç·šã˜ã‚ƒãªãã€åŒã˜ç›®ç·šã§ã€‚<br>
                    <br>
                    <span class="bg-teal-100 px-1">ã€Œã‚ã‹ã‚‹ã€œï¼ã€</span>ã£ã¦å…±æ„Ÿã—ã¦ã»ã—ã„æ™‚ã‚‚ã€<br>
                    <span class="bg-pink-100 px-1">ã€Œãã‚Œãªï¼ã€</span>ã£ã¦ç¬‘ã„åˆã„ãŸã„æ™‚ã‚‚ã€‚<br>
                    Ainaã¯ã„ã¤ã§ã‚‚ã€ã‚ãªãŸã®ãƒã‚±ãƒƒãƒˆã«ã€‚
                </p>

                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-white p-4 rounded-xl border border-gray-100">
                        <h3 class="font-black text-teal-500 mb-1">ï¼ƒç›¸è«‡ç›¸æ‰‹</h3>
                        <p class="text-xs text-gray-500 font-bold">æ‹ãƒãƒŠã‚‚é€²è·¯ã‚‚<br>ãªã‚“ã§ã‚‚èãã‚ˆ</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl border border-gray-100">
                        <h3 class="font-black text-pink-400 mb-1">ï¼ƒèª¿æ•´å½¹</h3>
                        <p class="text-xs text-gray-500 font-bold">äºˆå®šæ±ºã‚ã‚„<br>ä¼šè©±ã®è¦ç´„ã‚‚ï¼</p>
                    </div>
                </div>

                <div class="mt-8">
                    <img src="public/chat.png" alt="Aina Chat Interface"
                        class="rounded-xl shadow-2xl w-full border-2 border-white/50">
                </div>
            </div>
        </section>

        <!-- Visual/Tech Section -->
        <section class="h-screen w-full flex items-center justify-center relative">
            <div class="text-center pointer-events-none z-10">
                <h2
                    class="text-[12vw] md:text-[15vw] font-black text-white mix-blend-overlay leading-none select-none opacity-50">
                    DIGITAL<br>BESTIE
                </h2>
            </div>
        </section>

        <!-- Footer -->
        <footer
            class="min-h-[60vh] w-full bg-white/10 backdrop-blur-lg border-t border-white/20 flex flex-col justify-center items-center relative overflow-hidden px-6">
            <div class="absolute inset-0 bg-gradient-to-t from-teal-50/80 to-transparent z-[-1]"></div>

            <h2 class="text-3xl md:text-6xl font-black text-gray-800 mb-8 text-center">
                Ainaã¨å‹é”ã«ãªã‚ã†
            </h2>
            <div class="flex flex-col md:flex-row gap-4">
                <a href="#"
                    class="px-8 py-3 bg-[#06C755] text-white rounded-full font-bold shadow-lg hover:scale-105 transition-transform flex items-center gap-2">
                    <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.627-.63h2.386c.349 0 .63.285.63.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.627-.63.349 0 .631.285.631.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.281.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314" />
                    </svg>
                    LINEã§è¿½åŠ 
                </a>
                <a href="#"
                    class="px-8 py-3 bg-gray-900 text-white rounded-full font-bold shadow-lg hover:scale-105 transition-transform">
                    ã‚¢ãƒ—ãƒªã‚’é–‹ã
                </a>
            </div>

            <!-- Footer Links -->
            <div class="mt-12 flex flex-wrap justify-center gap-6 text-sm text-gray-500">
                <a href="#" class="hover:text-teal-500 transition-colors">åˆ©ç”¨è¦ç´„</a>
                <a href="#" class="hover:text-teal-500 transition-colors">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
                <a href="#" class="hover:text-teal-500 transition-colors">ãŠå•ã„åˆã‚ã›</a>
            </div>

            <p class="mt-6 text-gray-400 font-pixel text-xs md:text-sm">Â© 2024 AI High School Girl Aina. All rights
                reserved.</p>
        </footer>

    </main>

    <script>
        // --- THREE.JS SETUP ---
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();

        // Camera Setup
        const camera = new THREE.PerspectiveCamera(35, window.innerWidth / window.innerHeight, 0.1, 100);
        camera.position.z = 6;

        // Renderer
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
        container.appendChild(renderer.domElement);

        // State & Mouse
        const mouse = new THREE.Vector2();
        const targetMouse = new THREE.Vector2();
        const windowHalf = new THREE.Vector2(window.innerWidth / 2, window.innerHeight / 2);

        // --- ASSETS & TEXTURE LOADING ---
        const loader = new THREE.TextureLoader();
        const loadingManager = new THREE.LoadingManager();

        loadingManager.onProgress = (url, loaded, total) => {
            const progress = (loaded / total) * 100;
            document.getElementById('progress').style.width = progress + '%';
        };

        loadingManager.onLoad = () => {
            gsap.to('#loader', {
                opacity: 0, duration: 0.8, onComplete: () => {
                    document.getElementById('loader').style.display = 'none';
                }
            });
        };

        const textureLoader = new THREE.TextureLoader(loadingManager);

        // ** IMPORTANT: Replace with actual image path if hosted differently **
        // Using the user provided filename
        const ainaTexture = textureLoader.load('public/Aina.png', (tex) => {
            // Adjust card aspect ratio to match image
            const imageAspect = tex.image.width / tex.image.height;
            const baseHeight = 3.5;
            card.scale.set(baseHeight * imageAspect, baseHeight, 1);

            // Initial Responsive Adjustment
            updateLayout();
        });

        // --- SHADERS ---

        // 1. Background Gradient Shader (Mint to Pink Lava Lamp)
        const bgGeometry = new THREE.PlaneGeometry(20, 20);
        const bgMaterial = new THREE.ShaderMaterial({
            uniforms: {
                uTime: { value: 0 },
                uColor1: { value: new THREE.Color('#b2f4e6') }, // Mint
                uColor2: { value: new THREE.Color('#ffc4d6') }, // Pink
                uColor3: { value: new THREE.Color('#ffffff') }, // White
            },
            vertexShader: `
                varying vec2 vUv;
                void main() {
                    vUv = uv;
                    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
                }
            `,
            fragmentShader: `
                uniform float uTime;
                uniform vec3 uColor1;
                uniform vec3 uColor2;
                uniform vec3 uColor3;
                varying vec2 vUv;

                // Simplex noise function (simplified)
                vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
                vec2 mod289(vec2 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
                vec3 permute(vec3 x) { return mod289(((x*34.0)+1.0)*x); }
                float snoise(vec2 v) {
                    const vec4 C = vec4(0.211324865405187, 0.366025403784439, -0.577350269189626, 0.024390243902439);
                    vec2 i  = floor(v + dot(v, C.yy) );
                    vec2 x0 = v - i + dot(i, C.xx);
                    vec2 i1;
                    i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
                    vec4 x12 = x0.xyxy + C.xxzz;
                    x12.xy -= i1;
                    i = mod289(i);
                    vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 )) + i.x + vec3(0.0, i1.x, 1.0 ));
                    vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
                    m = m*m ;
                    m = m*m ;
                    vec3 x = 2.0 * fract(p * C.www) - 1.0;
                    vec3 h = abs(x) - 0.5;
                    vec3 ox = floor(x + 0.5);
                    vec3 a0 = x - ox;
                    m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );
                    vec3 g;
                    g.x  = a0.x  * x0.x  + h.x  * x0.y;
                    g.yz = a0.yz * x12.xz + h.yz * x12.yw;
                    return 130.0 * dot(m, g);
                }

                void main() {
                    float noise = snoise(vUv * 2.0 + uTime * 0.1);
                    float noise2 = snoise(vUv * 4.0 - uTime * 0.15);
                    
                    vec3 color = mix(uColor1, uColor2, (noise + 1.0) * 0.5);
                    color = mix(color, uColor3, (noise2 + 0.5) * 0.3); // Add white highlights
                    
                    // Add subtle gradient to ensure text readability usually
                    float vignette = distance(vUv, vec2(0.5));
                    color = mix(color, vec3(1.0), vignette * 0.3);

                    gl_FragColor = vec4(color, 1.0);
                }
            `
        });
        const bgMesh = new THREE.Mesh(bgGeometry, bgMaterial);
        bgMesh.position.z = -5;
        scene.add(bgMesh);


        // 2. The Main Character Card (Aina)
        // Standard material for clean, non-distorted display
        const cardGeometry = new THREE.PlaneGeometry(1, 1);
        const cardMaterial = new THREE.MeshBasicMaterial({
            map: ainaTexture,
            transparent: true,
            side: THREE.DoubleSide
        });
        const card = new THREE.Mesh(cardGeometry, cardMaterial);
        card.position.x = 1.5; // Start on the right side
        scene.add(card);

        // 3. Floating 3D Elements (Stars)
        const shapesGroup = new THREE.Group();
        scene.add(shapesGroup);

        const starShape = new THREE.Shape();
        const points = 5;
        const outerRadius = 0.3;
        const innerRadius = 0.15;

        for (let i = 0; i < points * 2; i++) {
            const radius = i % 2 === 0 ? outerRadius : innerRadius;
            const angle = (i / (points * 2)) * Math.PI * 2;
            const a = angle - Math.PI / 2;

            const x = Math.cos(a) * radius;
            const y = Math.sin(a) * radius;

            if (i === 0) starShape.moveTo(x, y);
            else starShape.lineTo(x, y);
        }
        starShape.closePath();

        // Detect device early for star generation
        const isMobileForStars = window.innerWidth < 768;

        const particles = [];

        if (isMobileForStars) {
            // ========== MOBILE STARS ==========
            // Fewer, smaller, closer to camera
            const mobileShapeGeo = new THREE.ExtrudeGeometry(starShape, {
                depth: 0.08,
                bevelEnabled: true,
                bevelSize: 0.01,
                bevelThickness: 0.01
            });
            const shapeMat = new THREE.MeshNormalMaterial({ wireframe: false });

            for (let i = 0; i < 6; i++) {
                const mesh = new THREE.Mesh(mobileShapeGeo, shapeMat);

                // Smaller spread, positioned around edges of screen
                mesh.position.set(
                    (Math.random() - 0.5) * 4,
                    (Math.random() - 0.5) * 6,
                    (Math.random() - 0.5) * 2 - 1
                );

                // Smaller scale for mobile
                mesh.scale.setScalar(0.6);

                mesh.rotation.x = Math.random() * Math.PI;
                mesh.rotation.y = Math.random() * Math.PI;

                mesh.userData = {
                    speed: Math.random() * 0.01 + 0.005,
                    rotSpeed: Math.random() * 0.015
                };

                shapesGroup.add(mesh);
                particles.push(mesh);
            }
        } else {
            // ========== DESKTOP STARS ==========
            // Original: more stars, larger spread
            const shapeGeo = new THREE.ExtrudeGeometry(starShape, {
                depth: 0.1,
                bevelEnabled: true,
                bevelSize: 0.02,
                bevelThickness: 0.02
            });
            const shapeMat = new THREE.MeshNormalMaterial({ wireframe: false });

            for (let i = 0; i < 15; i++) {
                const mesh = new THREE.Mesh(shapeGeo, shapeMat);

                mesh.position.set(
                    (Math.random() - 0.5) * 10,
                    (Math.random() - 0.5) * 10,
                    (Math.random() - 0.5) * 5
                );

                mesh.rotation.x = Math.random() * Math.PI;
                mesh.rotation.y = Math.random() * Math.PI;

                mesh.userData = {
                    speed: Math.random() * 0.01 + 0.005,
                    rotSpeed: Math.random() * 0.02
                };

                shapesGroup.add(mesh);
                particles.push(mesh);
            }
        }


        // ============================================
        // DEVICE DETECTION
        // ============================================
        const isMobile = window.innerWidth < 768;

        // ============================================
        // MOBILE SETUP
        // ============================================
        function setupMobile() {
            // Mobile: Position Aina at center, smaller
            card.position.set(0, -0.8, 0);
            camera.position.z = 6;

            // Make Aina smaller on mobile
            card.scale.multiplyScalar(0.5);
        }

        // ============================================
        // DESKTOP SETUP 
        // ============================================
        function setupDesktop() {
            // Desktop: Position Aina on the right side
            card.position.set(1.5, 0, 0);
            camera.position.z = 6;
        }

        // ============================================
        // RESPONSIVE LAYOUT (called after texture loads)
        // ============================================
        function updateLayout() {
            if (isMobile) {
                setupMobile();
            } else {
                setupDesktop();
            }
        }

        // --- EVENT LISTENERS ---

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            windowHalf.set(window.innerWidth / 2, window.innerHeight / 2);
        });

        document.addEventListener('mousemove', (e) => {
            // Normalize mouse position -1 to 1
            targetMouse.x = (e.clientX - windowHalf.x) / windowHalf.x;
            targetMouse.y = (e.clientY - windowHalf.y) / windowHalf.y;
        });

        // ============================================
        // GSAP ANIMATIONS - COMPLETELY SEPARATE
        // ============================================

        gsap.registerPlugin(ScrollTrigger);

        if (isMobile) {
            // ========== MOBILE ANIMATIONS ==========
            // Simple: Fade out when scrolling to features, fade in at footer

            gsap.to(cardMaterial, {
                scrollTrigger: {
                    trigger: "#features",
                    start: "top 100%",
                    end: "top 60%",
                    scrub: true,
                },
                opacity: 0,
            });

            gsap.to(cardMaterial, {
                scrollTrigger: {
                    trigger: "footer",
                    start: "top 100%",
                    end: "top 70%",
                    scrub: true,
                },
                opacity: 1,
            });

        } else {
            // ========== DESKTOP ANIMATIONS ==========
            // Rich scroll-based 3D animation

            const tl = gsap.timeline({
                scrollTrigger: {
                    trigger: "body",
                    start: "top top",
                    end: "bottom bottom",
                    scrub: 1.5
                }
            });

            // Intro: Card floats in from below
            gsap.from(card.position, { y: -5, duration: 1.5, ease: "elastic.out(1, 0.5)" });

            // Scroll animation steps
            tl.to(card.position, { x: -2, z: 1, duration: 2 }, 0)
                .to(card.rotation, { y: 0.5, duration: 2 }, 0)
                .to(card.position, { x: 0, y: 0, z: 2.5, duration: 2 })
                .to(card.rotation, { y: 0, z: 0.2, duration: 2 }, "<");

            // Background color shift
            tl.to(bgMaterial.uniforms.uColor1.value, { r: 1.0, g: 0.9, b: 0.9, duration: 3 }, 0);
        }


        // ============================================
        // ANIMATION LOOP
        // ============================================
        const clock = new THREE.Clock();

        function animate() {
            requestAnimationFrame(animate);

            const time = clock.getElapsedTime();

            // Update Shader Time
            bgMaterial.uniforms.uTime.value = time;

            // Smooth Mouse Follow for Camera (Parallax) - Desktop only
            if (!isMobile) {
                mouse.x += (targetMouse.x - mouse.x) * 0.05;
                mouse.y += (targetMouse.y - mouse.y) * 0.05;

                camera.position.x += (mouse.x * 0.5 - camera.position.x) * 0.05;
                camera.position.y += (-mouse.y * 0.5 - camera.position.y) * 0.05;
            }
            camera.lookAt(0, 0, 0);

            // Floating Particles Animation
            particles.forEach((mesh, i) => {
                if (!mesh.visible) return;
                mesh.position.y += Math.sin(time + i) * 0.002;
                mesh.rotation.x += mesh.userData.rotSpeed;
                mesh.rotation.y += mesh.userData.rotSpeed;
            });

            // Card Idle Animation
            card.rotation.z = Math.sin(time * 0.5) * 0.05;

            renderer.render(scene, camera);
        }

        animate();

    </script>
</body>

</html>